---
id: 2024.2.27.
created_date: 2024-02-27
updated_date: 2024-02-27
type: post
link: 
tags:
  - Cloud
  - Cloud/AWS
  - Cloud/Serverless
  - Python
---

# ğŸ—“ï¸ 2024.2.27. AWS Lambda ë° ì‹¤ìŠµ 1
- **ğŸ·ï¸Tags** :   #02-2024 #Cloud #Cloud/AWS #Cloud/Serverless #Python 

## ğŸ“ ì˜¤ëŠ˜ ìˆ˜ì—… ë‚´ìš© ì •ë¦¬
- ì„œë²„ë¦¬ìŠ¤ ê°œë… ê°œìš”
- AWS Lambda
- Lambdaë¥¼ í†µí•œ RDB ë° DyanmoDBì˜ CRUD ë“± ì œì–´
## ğŸ¯ ì˜¤ëŠ˜ì˜ ë¯¸ì…˜
1. Lambda ë§¤ë‰´ì–¼ ìˆ™ì§€ í›„ ì•„ë˜ì™€ ê°™ì€ ì‹¤ìŠµ ì§„í–‰:
	1) DynamoDB ê²°ê³¼ëŠ” AWS CLIë¡œ í™•ì¸í•˜ê¸°.
2. Probono í”„ë¡œì íŠ¸ì˜ DBë¥¼ AWS RDSì™€ ì—°ê²°ì‹œí‚¬ ê²ƒ.
	1) ì´ë•Œ Probono í”„ë¡œì íŠ¸ëŠ” EC2ë¡œ êµ¬ë™.
	2) EC2ì—ì„œ RDS ì ‘ì†ì„ ì„±ê³µì‹œí‚¤ì.

## ğŸ› ï¸ Step-by-Step íŠœí† ë¦¬ì–¼

### ë¯¸ì…˜ 1. Lambda + DynamoDB
- **ë¯¸ì…˜ ë‚´ìš©**:
	- https://catalog.us-east-1.prod.workshops.aws/workshops/600420b7-5c4c-498f-9b80-bc7798963ba3/ko-KR/serverless
- **ì‘ì—…**:
  1. DynamoDBì— í…Œì´ë¸” ìƒì„±
  2. ì„œë²„ë¦¬ìŠ¤ êµ¬ë™ì„ ìœ„í•œ API Gateway ìƒì„± 
  3. ì„œë²„ë¦¬ìŠ¤ í•¨ìˆ˜ ìƒì„± ë° ë°°í¬
  4. í…ŒìŠ¤íŠ¸ë¥¼ í†µí•´ ì‹¤ì œë¡œ DynamoDBì˜ ê²°ê³¼ë¥¼ í™•ì¸
#### ğŸ“ DynamoDBì— í…Œì´ë¸” ìƒì„± ğŸšš
- **ìƒì„¸**:
  1. DynamoDBì— `hello-member-gabe`ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ í…Œì´ë¸”ì„ ìƒì„±
  2. ìƒì„±í•œ ê²°ê³¼ í™•ì¸:
![[Pasted image 20240227142720.png|700]]

#### ì„œë²„ë¦¬ìŠ¤ êµ¬ë™ì„ ìœ„í•œ API Gateway ìƒì„±
- **ìƒì„¸**:
  1. API Gatewayì— `gabe-api`ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ APIë¥¼ ìƒì„±
![[Pasted image 20240227143609.png|600]]
  2. ë‹¨, REST APIë¥¼ ìƒì„±í•´ì•¼ í•¨
![[Pasted image 20240227143501.png|500]]	
  3. ìƒì„± ê²°ê³¼ í™•ì¸
![[Pasted image 20240227143652.png]]

#### API Service Lambda ìƒì„±
1. Create Function í´ë¦­, Author from Scratch í´ë¦­, Python 3 ë²„ì „ëŒ€ë¥¼ ì„ íƒ
2. ì•„ë˜ì™€ ê°™ì€ 'Simple microservice permission' ì„ íƒ
![[Pasted image 20240227144953.png|550]]
4. `api-service-create-gabe`ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ í•¨ìˆ˜ë¥¼ ìƒì„±
5. ì•„ë˜ì™€ ê°™ì€ ì½”ë“œë¥¼ ì‘ì„±, ë‹¨, `dynamodb.Table()` í•¨ìˆ˜ì— DynamoDB í…Œì´ë¸”ëª…ì„ ì§ì ‘ ì¨ë„£ì–´ì•¼ í•¨.
```python
import json
import boto3
import random
import json

def lambda_handler(event, context):
    
    member_name = ['Ama','Jone','Zon','Penny','Jessie']
    member_status = ['Happy','Sad','Serious','Satisfied','Free']
    
    dynamodb = boto3.resource('dynamodb',endpoint_url='http://dynamodb.ap-northeast-2.amazonaws.com')
    member_table = dynamodb.Table('hello-member-gabe')
    
    name = member_name[random.randint(0,4)]
    status = member_status[random.randint(0, 4)]
    
    member_table.put_item(
       Item={
            'name': name,
            'status': status,
        }
    )
    
    documents = {'name':name,'status':status}
    
    print(documents)
    
    return {
        'statusCode': 200,
        'headers': {'Access-Control-Allow-Origin': '*'},
        'body': json.dumps(documents)
    }
```
6. Test ì‹¤í–‰ ë’¤ DynamoDBì˜ í…Œì´ë¸”ì˜ ê²°ê³¼ë¥¼ í™•ì¸
![[Pasted image 20240227145318.png|500]]

#### ìƒì„±ëœ Lambda functionì„ API Gatewayì— ì—°ë™
1. ì•„ê¹Œ ë§Œë“  `gabe-api`ë¼ëŠ” API Gatewayì—ì„œ Create method í´ë¦­
![[Pasted image 20240227153034.png]]
2. ì•„ê¹Œ ë§Œë“  `api-service-create-gabe`ë¥¼ ì•„ë˜ì™€ ê°™ì€ ë°©ì‹ìœ¼ë¡œ ì—°ë™
![[Pasted image 20240227153107.png]]
3. Test í›„ responseë¥¼ í™•ì¸
![[Pasted image 20240227153218.png|600]]
![[Pasted image 20240227153645.png|600]]


## ğŸ“š ì°¸ê³ ìë£Œ
- AWS CLIì˜ DynamoDB í•­ëª© ê³µì‹ ë¬¸ì„œ: https://awscli.amazonaws.com/v2/documentation/api/latest/reference/dynamodb/index.html#cli-aws-dynamodb
- AWS Builders Korea ê¸°ì´ˆ ê³¼ì • ì‹¤ìŠµ - Web Application with Serverless: https://catalog.us-east-1.prod.workshops.aws/workshops/600420b7-5c4c-498f-9b80-bc7798963ba3/ko-KR/serverless