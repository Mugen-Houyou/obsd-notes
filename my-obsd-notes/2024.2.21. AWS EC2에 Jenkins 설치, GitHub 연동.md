---
id: Untitled
created_date: 2024-02-21
updated_date: 2024-02-21
type: post
link: 
tags:
  - CI_CD
  - CI_CD/Jenkins
  - Cloud
---
![[Pasted image 20240221163140.png]]
# 2024.2.21. AWS EC2ì— Jenkins ì„¤ì¹˜ ë° GitHub ì—°ë™
- **ğŸ·ï¸Tags** :   #02-2024 #CI_CD #CI_CD/Jenkins #Cloud 

# 2ì°¨ ê³¼ì œ: AWS EC2ì— ì„¤ì¹˜ ë° ì—°ë™

### Ubuntu EC2 ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
- ê²°ê³¼:
![[Pasted image 20240221163430.png]]
### Spring í…ŒìŠ¤íŠ¸ í”„ë¡œì íŠ¸ & GitHub ë ˆí¬ì§€í† ë¦¬ ìƒì„±
- ì•„ë˜ì™€ ê°™ì´ GET http://localhost:57253/citest/getdata ìš”ì²­ì„ ë°›ëŠ” ê°„ë‹¨í•œ Spring í”„ë¡œì íŠ¸ë¥¼ ìƒì„±, GItHubì— ë°°í¬í•˜ì˜€ìŒ.
![[Pasted image 20240221154944.png]]
- GitHub ë ˆí¬ì§€í† ë¦¬ URL: https://github.com/Mugen-Houyou/fisa_testrep_240920

### Jenkins ì§ì ‘ ì„¤ì¹˜ (feat. AWS EC2 ì¸ìŠ¤í„´ìŠ¤)
- EC2 ì¸ìŠ¤í„´ìŠ¤ì— Dockerë¥¼ ì„¤ì¹˜í•˜ë‹ˆ ìê¾¸ ì¸ìŠ¤í„´ìŠ¤ê°€ ì‚¬ë§í•˜ëŠ” ë¬¸ì œê°€ ë°œìƒ
- Free tierë¡œ ê°ë‹¹ ê°€ëŠ¥í•œ ìˆ˜ì¤€ìœ¼ë¡œ êµ¬ì„±í•˜ê¸° ìœ„í•´, ì¸ìŠ¤í„´ìŠ¤ì— ì§ì ‘ ì„¤ì¹˜ ë°©ì‹ì„ ì±„íƒí•˜ì˜€ìŒ.
- EC2 Ubuntu ì¸ìŠ¤í„´ìŠ¤ì— Jenkins ì§ì ‘ ì„¤ì¹˜
	- ê³µì‹ ë¬¸ì„œì— ë”°ë¼ ì„¤ì¹˜í•˜ì˜€ìŒ.
	- https://www.jenkins.io/doc/book/installing/linux/
- **ë˜ ì£½ì–´ì„œ** ê²€ìƒ‰í•´ë³¸ ê²°ê³¼, EC2 free tierì˜ **ê¸°ë³¸ ë©”ëª¨ë¦¬ ìš©ëŸ‰ì€ 1GB**ë¼ëŠ” ê²ƒì„ í™•ì¸
	- í•´ê²°ì±… 
		- ì•„ë˜ì™€ ê°™ì€ ë°©ë²•ìœ¼ë¡œ 2GBì˜ swap memory êµ¬ì„±:
```bash
sudo dd if=/dev/zero of=/swapfile bs=128M count=16
sudo chmod 600 /swapfile
sudo mkswap /swapfile
sudo swapon /swapfile
sudo swapon -s
``` 
        - ë˜í•œ, `/etc/fstab`ì— ì•„ë˜ë¥¼ ì¶”ê°€í•˜ì—¬ ì¬ë¶€íŒ…í•´ë„ ì ìš©ë˜ë„ë¡ êµ¬ì„±:
```bash
/swapfile swap swap defaults 0 0
``` 
   -  ì´í›„ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì¬ì‹œì‘, `free -h`ë¥¼ í†µí•´ ì•„ë˜ì™€ ê°™ì´ swap memory êµ¬ì„±ì„ í™•ì¸:
![[Pasted image 20240222144341.png]]

- ì„¤ì¹˜ í›„ í™”ë©´:
![[Pasted image 20240221155326.png]]

### Jenkinsì— ìƒˆë¡œìš´ Pipeline ë° GitHub ë ˆí¬ì§€í† ë¦¬ ì—°ë™
- ì•„ë˜ì™€ ê°™ì´ **New Item** í´ë¦­:
![[Pasted image 20240221155655.png|250]]
- ì•„ë˜ì™€ ê°™ì´ **item name** ì§€ì • í›„ **Pipeline**ìœ¼ë¡œ ìƒˆ ì•„ì´í…œ ìƒì„±:
![[Pasted image 20240221155937.png]]
- ì•„ë˜ì™€ ê°™ì´ **GitHub project** ì²´í¬, **ë ˆí¬ì§€í† ë¦¬ URL** ì§€ì •:
![[Pasted image 20240221160250.png]]
- ì•„ë˜ì™€ ê°™ì´ **GitHub hook trigger for GITScm polling** ì²´í¬:
![[Pasted image 20240221160359.png]]
- ì•„ë˜ì™€ ê°™ì´ pipeline ì½”ë“œë¥¼ êµ¬ì„±:
```
pipeline {
    agent any

    stages {
        stage('Build') {
            steps {
                git branch:'main',
                credentialsId: 'f4dfc070-f8f4-4045-81aa-f65a60b28355', 
                url: 'https://github.com/Mugen-Houyou/fisa_testrep_240920.git'
            }

            post {
                success {
                    echo "success!"
                }
            }
        }
        
        stage('list view') {
            steps {
                echo 'now showing contents'
                sh '''whoami'''
                sh '''pwd'''
                sh '''ls -al'''
                echo 'finished showing contents'
            }
        }
        stage('stage for gradle build') {
            steps {
                echo 'now building with gradlew'
                sh ''' ./gradlew build '''
                echo 'finished building with gradlew'
            }
        }
    }
}
```
- Pipeline Syntaxì—ì„œ Git credentials êµ¬ì„± ì˜ˆì‹œ:
![[Screenshot 2024-02-21 at 17-14-41 Pipeline Syntax Snippet Generator Jenkins.png]]
![[Pasted image 20240221171844.png]]
- ì•„ë˜ì™€ ê°™ì´ Build Nowë¥¼ ëˆŒëŸ¬ ë¹Œë“œ ì‹œì‘:
	![[Pasted image 20240221162754.png|250]]
- ì•„ë˜ì™€ ê°™ì´ Stage Viewì—ì„œ ë¹Œë“œ ê²°ê³¼ í™•ì¸:
	![[Pasted image 20240221172140.png|400]]

### Jenkinsì— GitHub Webhook êµ¬ì„± ë° ë™ê¸°í™”
- EC2 ì¸ìŠ¤í„´ìŠ¤ëŠ” ì´ë¯¸ ê³µì¸ IPë¥¼ ë°›ê³  ìˆìœ¼ë¯€ë¡œ ngrok ê°™ì€ ë„êµ¬ëŠ” í•„ìš”í•˜ì§€ ì•ŠìŒ.
- GitHub ë ˆí¬ì§€í† ë¦¬ì—ì„œ Settings í´ë¦­, Webhooks í´ë¦­
- ì•„ë˜ì™€ ê°™ì´ êµ¬ì„±, ë‹¨, URL ëì— `/github-webhook/`ë¥¼ ë¶™ì¸ ê²ƒì— ìœ ì˜:
![[Pasted image 20240221172611.png|700]]
- í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ README.md íŒŒì¼ì„ ì¼ë¶€ ìˆ˜ì •, ì»¤ë°‹, í‘¸ì‹œ:
![[Pasted image 20240221162336.png|600]]
- í‘¸ì‹œ í›„, Jenkinsì˜ Stage Viewì—ì„œ ìë™ìœ¼ë¡œ ë¹Œë“œëœ ê²ƒì„ í™•ì¸:
	![[Pasted image 20240221173132.png|300]]

